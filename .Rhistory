group_by(homeTeam) %>%
summarise(total_games = n(), total_home_wins = sum(homeWin),
home_capitalization = mean(homeWin)) %>%
filter(total_games >= 76) %>%
arrange(desc(home_capitalization))
# Ligue 1 (France)
football_europe_new_col_order %>%
filter(division == 'Ligue_1') %>%
group_by(homeTeam) %>%
summarise(total_games = n(), total_home_wins = sum(homeWin),
home_capitalization = mean(homeWin)) %>%
filter(total_games >= 76) %>%
arrange(desc(home_capitalization))
football_europe_new_col_order %>%
filter(division == 'Bundesliga') %>%
group_by(awayTeam) %>%
summarise(total_games = n(), total_away_wins = sum(awayWin),
away_capitalization = mean(awayWin)) %>%
filter(total_games >= 68) %>%
arrange(desc(away_capitalization))
65/85
football_europe_new_col_order %>%
filter(division == 'Bundesliga') %>%
group_by(awayTeam) %>%
summarise(total_games = n(), total_away_wins = sum(awayWin),
away_capitalization = mean(awayWin)) %>%
filter(total_games >= 68) %>%
arrange(desc(away_capitalization))
# La Liga (Spain)
football_europe_new_col_order %>%
filter(division == 'La_Liga') %>%
group_by(awayTeam) %>%
summarise(total_games = n(), total_away_wins = sum(awayWin),
away_capitalization = mean(awayWin)) %>%
filter(total_games >= 76) %>%
arrange(desc(away_capitalization))
# English Premier League (England)
football_europe_new_col_order %>%
filter(division == 'EPL') %>%
group_by(awayTeam) %>%
summarise(total_games = n(), total_away_wins = sum(awayWin),
away_capitalization = mean(awayWin)) %>%
filter(total_games >= 76) %>%
arrange(desc(away_capitalization))
# Serie A (Italy)
football_europe_new_col_order %>%
filter(division == 'Serie_A') %>%
group_by(awayTeam) %>%
summarise(total_games = n(), total_away_wins = sum(awayWin),
away_capitalization = mean(awayWin)) %>%
filter(total_games >= 76) %>%
arrange(desc(away_capitalization))
# Ligue 1 (France)
football_europe_new_col_order %>%
filter(division == 'Ligue_1') %>%
group_by(awayTeam) %>%
summarise(total_games = n(), total_away_wins = sum(awayWin),
away_capitalization = mean(awayWin)) %>%
filter(total_games >= 76) %>%
arrange(desc(away_capitalization))
76/2
football_europe_new_col_order %>%
filter(division == 'Bundesliga') %>%
group_by(homeTeam) %>%
summarise(total_games = n(), total_home_wins = sum(homeWin),
home_capitalization = mean(homeWin)) %>%
filter(total_games >= 34) %>%
arrange(desc(home_capitalization))
# La Liga (Spain)
football_europe_new_col_order %>%
filter(division == 'La_Liga') %>%
group_by(homeTeam) %>%
summarise(total_games = n(), total_home_wins = sum(homeWin),
home_capitalization = mean(homeWin)) %>%
filter(total_games >= 38) %>%
arrange(desc(home_capitalization))
# English Premier League (England)
football_europe_new_col_order %>%
filter(division == 'EPL') %>%
group_by(homeTeam) %>%
summarise(total_games = n(), total_home_wins = sum(homeWin),
home_capitalization = mean(homeWin)) %>%
filter(total_games >= 38) %>%
arrange(desc(home_capitalization))
# Serie A (Italy)
football_europe_new_col_order %>%
filter(division == 'Serie_A') %>%
group_by(homeTeam) %>%
summarise(total_games = n(), total_home_wins = sum(homeWin),
home_capitalization = mean(homeWin)) %>%
filter(total_games >= 38) %>%
arrange(desc(home_capitalization))
# Ligue 1 (France)
football_europe_new_col_order %>%
filter(division == 'Ligue_1') %>%
group_by(homeTeam) %>%
summarise(total_games = n(), total_home_wins = sum(homeWin),
home_capitalization = mean(homeWin)) %>%
filter(total_games >= 38) %>%
arrange(desc(home_capitalization))
# Away capitalization for comparison
# Bundesliga (Germany)
football_europe_new_col_order %>%
filter(division == 'Bundesliga') %>%
group_by(awayTeam) %>%
summarise(total_games = n(), total_away_wins = sum(awayWin),
away_capitalization = mean(awayWin)) %>%
filter(total_games >= 34) %>%
arrange(desc(away_capitalization))
# La Liga (Spain)
football_europe_new_col_order %>%
filter(division == 'La_Liga') %>%
group_by(awayTeam) %>%
summarise(total_games = n(), total_away_wins = sum(awayWin),
away_capitalization = mean(awayWin)) %>%
filter(total_games >= 38) %>%
arrange(desc(away_capitalization))
# English Premier League (England)
football_europe_new_col_order %>%
filter(division == 'EPL') %>%
group_by(awayTeam) %>%
summarise(total_games = n(), total_away_wins = sum(awayWin),
away_capitalization = mean(awayWin)) %>%
filter(total_games >= 38) %>%
arrange(desc(away_capitalization))
# Serie A (Italy)
football_europe_new_col_order %>%
filter(division == 'Serie_A') %>%
group_by(awayTeam) %>%
summarise(total_games = n(), total_away_wins = sum(awayWin),
away_capitalization = mean(awayWin)) %>%
filter(total_games >= 38) %>%
arrange(desc(away_capitalization))
# Ligue 1 (France)
football_europe_new_col_order %>%
filter(division == 'Ligue_1') %>%
group_by(awayTeam) %>%
summarise(total_games = n(), total_away_wins = sum(awayWin),
away_capitalization = mean(awayWin)) %>%
filter(total_games >= 38) %>%
arrange(desc(away_capitalization))
football_europe_new_col_order %>%
filter(division == 'Ligue_1') %>%
group_by(season, awayTeam) %>%
summarise(total_games = n(), total_away_wins = sum(awayWin),
away_capitalization = mean(awayWin)) %>%
filter(total_games >= 38) %>%
arrange(desc(away_capitalization))
football_europe_new_col_order %>%
filter(division == 'Ligue_1') %>%
group_by(season) %>%
summarise(total_games = n(), total_away_wins = sum(awayWin),
away_capitalization = mean(awayWin)) %>%
filter(total_games >= 38) %>%
arrange(desc(away_capitalization))
football_europe_new_col_order %>%
filter(division == 'Ligue_1') %>%
group_by(awayTeam,season) %>%
summarise(total_games = n(), total_away_wins = sum(awayWin),
away_capitalization = mean(awayWin)) %>%
filter(total_games >= 38) %>%
arrange(desc(away_capitalization))
football_europe_new_col_order %>%
filter(division == 'Ligue_1') %>%
group_by(awayTeam, season) %>%
summarise(total_games = n(), total_away_wins = sum(awayWin),
away_capitalization = mean(awayWin)) %>%
filter(total_games >= 38) %>%
arrange(desc(away_capitalization))
football_europe_new_col_order %>%
filter(division == 'Ligue_1') %>%
group_by(awayTeam, season)
football_europe_new_col_order %>%
filter(division == 'Ligue_1') %>%
group_by(awayTeam, season) %>%
summarise(total_games = n())
football_europe_new_col_order %>%
filter(division == 'Ligue_1') %>%
group_by(awayTeam, season) %>%
summarise(total_games = n(), total_away_wins = sum(awayWin),
away_capitalization = mean(awayWin)) %>%
arrange(desc(away_capitalization))
football_europe_new_col_order %>%
filter(division == 'Ligue_1') %>%
group_by(awayTeam, season) %>%
summarise(total_games = n(), total_away_wins = sum(awayWin),
away_capitalization = mean(awayWin))
football_europe_new_col_order %>%
filter(division == 'Ligue_1') %>%
group_by(awayTeam, season) %>%
summarise(total_games = n(), total_away_wins = sum(awayWin),
away_capitalization = mean(awayWin)) %>%
arrange(desc(total_away_wins))
football_europe_new_col_order %>%
filter(division == 'Ligue_1') %>%
group_by(awayTeam, season) %>%
summarise(total_games = n(), total_away_wins = sum(awayWin),
away_capitalization = mean(awayWin)) %>%
arrange(desc(awayTeam))
football_europe_new_col_order %>%
filter(division == 'Ligue_1') %>%
group_by(awayTeam, season) %>%
summarise(total_games = n(), total_away_wins = sum(awayWin),
away_capitalization = mean(awayWin)) %>%
arrange(desc(away_capitalization))
football_europe_new_col_order %>%
filter(division == 'Ligue_1') %>%
group_by(awayTeam, season) %>%
summarise(total_games = n(), total_away_wins = sum(awayWin),
away_capitalization = mean(awayWin))
football_europe_new_col_order %>%
filter(division == 'Ligue_1') %>%
group_by(season, awayTeam) %>%
summarise(total_games = n(), total_away_wins = sum(awayWin),
away_capitalization = mean(awayWin))
football_europe_new_col_order %>%
filter(division == 'Ligue_1') %>%
group_by(awayTeam, season) %>%
summarise(total_games = n(), total_away_wins = sum(awayWin),
away_capitalization = mean(awayWin)) %>%
arrange(desc(away_capitalization))
football_europe_new_col_order %>%
filter(division == 'Ligue_1') %>%
group_by(awayTeam, season) %>%
summarise(total_games = n(), total_away_wins = sum(awayWin),
away_capitalization = mean(awayWin))
football_europe_new_col_order %>%
filter(division == 'Ligue_1') %>%
group_by(awayTeam, season) %>%
summarise(total_games = n(), total_away_wins = sum(awayWin),
away_capitalization = mean(awayWin)) %>%
arrange(awayTeam, desc(away_capitalization))
football_europe_new_col_order %>%
filter(division == 'Ligue_1') %>%
group_by(awayTeam, season) %>%
summarise(total_games = n(), total_away_wins = sum(awayWin),
away_capitalization = mean(awayWin)) %>%
arrange(awayTeam, desc(away_capitalization))
cm
library(rms)
install.packages(rms)
install.packages('rms')
library(rms)
vif(classifier)
football_europe_new_col_order %>%
filter(division == 'Ligue_1') %>%
group_by(homeTeam) %>%
summarise(total_games = n(), total_home_wins = sum(homeWin),
home_capitalization = mean(homeWin)) %>%
filter(total_games >= 38) %>%
arrange(desc(home_capitalization))
football_europe_new_col_order %>%
filter(division == 'Ligue_1') %>%
group_by(awayTeam) %>%
summarise(total_games = n(), total_away_wins = sum(awayWin),
away_capitalization = mean(awayWin)) %>%
filter(total_games >= 38) %>%
arrange(desc(away_capitalization))
# Home
football_europe_new_col_order %>%
filter(division == 'Bundesliga') %>%
group_by(homeTeam) %>%
summarise(total_games = n(), total_home_wins = sum(homeWin),
home_capitalization = mean(homeWin)) %>%
filter(total_games >= 34) %>%
arrange(desc(home_capitalization))
# Away
football_europe_new_col_order %>%
filter(division == 'Bundesliga') %>%
group_by(awayTeam) %>%
summarise(total_games = n(), total_away_wins = sum(awayWin),
away_capitalization = mean(awayWin)) %>%
filter(total_games >= 38) %>%
arrange(desc(away_capitalization))
cm
football_europe_new_col_order %>%
group_by(win_type) %>%
count() %>%
arrange(desc(n))
football_europe_new_col_order %>%
ggplot(mapping = aes(x = win_type)) +
geom_histogram(stat = 'count', fill = 'dark blue', color = 'black') +
ggtitle('Number of Wins by Type (All Leagues 2012-2017)') +
xlab('Win Type') +
ylab('Number of Wins')
football_europe_new_col_order %>%
ggplot(mapping = aes(x = win_type)) +
geom_histogram(stat = 'count', fill = 'dark blue', color = 'black') +
ggtitle('Number of Wins by Type (All Leagues 2012-2017)') +
xlab('Win Type') +
ylab('Total Count')
data.frame(away_result, home_result)
football_europe_new_col_order %>%
select('division') %>%
distinct()
data.frame(full, by_league)
home_field_cap_by_league_final
EPL_away_cap <- mean(football_europe_nco_EPL$awayWin) + (mean(football_europe_nco_EPL$draw) * .65)
EPL_away_cap
EPL_away_cap <- mean(football_europe_nco_EPL$awayWin) + (mean(football_europe_nco_EPL$draw) * .65)
Bundesliga_away_cap <- mean(football_europe_nco_Bundesliga$awayWin) +
(mean(football_europe_nco_Bundesliga$draw) * .65)
Ligue_1_away_cap <- mean(football_europe_nco_Ligue_1$awayWin) +
(mean(football_europe_nco_Ligue_1$draw) * .65)
La_Liga_away_cap <- mean(football_europe_nco_La_Liga$awayWin) +
(mean(football_europe_nco_La_Liga$draw) * .65)
Serie_A_away_cap <- mean(football_europe_nco_Serie_A$awayWin) +
(mean(football_europe_nco_Serie_A$draw) * .65)
away_cap_pct <- c(EPL_away_cap, Bundesliga_away_cap, Ligue_1_away_cap, La_Liga_away_cap, Serie_A_away_cap)
away_cap_by_league <- data.frame(League, away_cap_pct)
away_cap_by_league_final <- away_cap_by_league %>%
arrange(desc(away_cap_pct))
away_cap_by_league_final
EPL_away_cap_weigthed <- mean(football_europe_nco_EPL$awayWin) + (mean(football_europe_nco_EPL$draw) * .65)
Bundesliga_away_cap_weigthed <- mean(football_europe_nco_Bundesliga$awayWin) +
(mean(football_europe_nco_Bundesliga$draw) * .65)
Ligue_1_away_cap_weigthed <- mean(football_europe_nco_Ligue_1$awayWin) +
(mean(football_europe_nco_Ligue_1$draw) * .65)
La_Liga_away_cap_weigthed <- mean(football_europe_nco_La_Liga$awayWin) +
(mean(football_europe_nco_La_Liga$draw) * .65)
Serie_A_away_cap_weigthed <- mean(football_europe_nco_Serie_A$awayWin) +
(mean(football_europe_nco_Serie_A$draw) * .65)
EPL_away_cap <- mean(football_europe_nco_EPL$awayWin)
Bundesliga_away_cap <- mean(football_europe_nco_Bundesliga$awayWin)
Ligue_1_away_cap <- mean(football_europe_nco_Ligue_1$awayWin)
La_Liga_away_cap <- mean(football_europe_nco_La_Liga$awayWin)
Serie_A_away_cap <- mean(football_europe_nco_Serie_A$awayWin)
away_cap_pct <- c(EPL_away_cap, Bundesliga_away_cap, Ligue_1_away_cap, La_Liga_away_cap, Serie_A_away_cap)
away_cap_pct_weigthed <- c(EPL_away_cap_weigthed, Bundesliga_away_cap_weigthed, Ligue_1_away_cap_weigthed,
La_Liga_away_cap_weigthed, Serie_A_away_cap_weigthed, away_cap_by_league)
away_cap_pct <- c(EPL_away_cap, Bundesliga_away_cap, Ligue_1_away_cap, La_Liga_away_cap, Serie_A_away_cap)
away_cap_pct_weigthed <- c(EPL_away_cap_weigthed, Bundesliga_away_cap_weigthed, Ligue_1_away_cap_weigthed,
La_Liga_away_cap_weigthed, Serie_A_away_cap_weigthed, away_cap_by_league)
away_cap_by_league <- data.frame(League, away_cap_pct)
away_cap_by_league_weighted <- data.frame(League, away_cap_pct_weigthed)
away_cap_by_league_final <- away_cap_by_league %>%
arrange(desc(away_cap_pct))
away_cap_by_league_weighted_final <- away_cap_by_league_weighted %>%
arrange(desc(away_cap_pct_weigthed))
away_cap_by_league_final
away_cap_by_league_weighted_final
away_cap_pct_weigthed <- c(EPL_away_cap_weigthed, Bundesliga_away_cap_weigthed, Ligue_1_away_cap_weigthed,
La_Liga_away_cap_weigthed, Serie_A_away_cap_weigthed, away_cap_by_league)
away_cap_by_league_weighted_final <- away_cap_by_league_weighted %>%
arrange(desc(away_cap_pct_weigthed))
away_cap_by_league_weighted
data.frame(League, away_cap_pct_weigthed)
data.frame(League, away_cap_pct)
EPL_away_cap_weigthed
Bundesliga_away_cap_weigthed
Ligue_1_away_cap_weigthed
La_Liga_away_cap_weigthed
Serie_A_away_cap_weigthed
away_cap_pct
away_cap_pct_weigthed
c(EPL_away_cap_weigthed, Bundesliga_away_cap_weigthed, Ligue_1_away_cap_weigthed,
La_Liga_away_cap_weigthed, Serie_A_away_cap_weigthed, away_cap_by_league)
c(EPL_away_cap, Bundesliga_away_cap, Ligue_1_away_cap, La_Liga_away_cap, Serie_A_away_cap)
class(away_cap_pct_weigthed)
class(away_cap_pct)
class(EPL_away_cap)
class(EPL_away_cap_weigthed)
away_cap_pct_weigthed <- c(EPL_away_cap_weigthed, Bundesliga_away_cap_weigthed, Ligue_1_away_cap_weigthed,
La_Liga_away_cap_weigthed, Serie_A_away_cap_weigthed)
away_cap_by_league <- data.frame(League, away_cap_pct)
away_cap_by_league_weighted <- data.frame(League, away_cap_pct_weigthed)
away_cap_by_league_final <- away_cap_by_league %>%
arrange(desc(away_cap_pct))
away_cap_by_league_weighted_final <- away_cap_by_league_weighted %>%
arrange(desc(away_cap_pct_weigthed))
away_cap_by_league_final
away_cap_by_league_weighted_final
home_field_cap_by_league_final
away_cap_by_league_final
away_cap_by_league_weighted_final
away_cap_by_league_final %>%
ggplot(aes(x = reorder(League, -away_cap_pct) , y = away_cap_pct,
fill = away_cap_pct)) +
geom_bar(stat = 'identity') +
xlab('League') +
ylab('Away Capitalization')
away_cap_by_league_weighted_final %>%
ggplot(aes(x = reorder(League, -away_cap_weighted_pct) , y = away_cap_weighted_pct,
fill = away_cap_weighted_pct)) +
geom_bar(stat = 'identity') +
xlab('League') +
ylab('Away Capitalization (Weighted)')
EPL_away_cap_weighted <- mean(football_europe_nco_EPL$awayWin) + (mean(football_europe_nco_EPL$draw) * .65)
Bundesliga_away_cap_weighted <- mean(football_europe_nco_Bundesliga$awayWin) +
(mean(football_europe_nco_Bundesliga$draw) * .65)
Ligue_1_away_cap_weighted <- mean(football_europe_nco_Ligue_1$awayWin) +
(mean(football_europe_nco_Ligue_1$draw) * .65)
La_Liga_away_cap_weighted <- mean(football_europe_nco_La_Liga$awayWin) +
(mean(football_europe_nco_La_Liga$draw) * .65)
Serie_A_away_cap_weighted <- mean(football_europe_nco_Serie_A$awayWin) +
(mean(football_europe_nco_Serie_A$draw) * .65)
away_cap_pct <- c(EPL_away_cap, Bundesliga_away_cap, Ligue_1_away_cap, La_Liga_away_cap, Serie_A_away_cap)
away_cap_pct_weighted <- c(EPL_away_cap_weighted, Bundesliga_away_cap_weighted, Ligue_1_away_cap_weighted,
La_Liga_away_cap_weighted, Serie_A_away_cap_weighted)
away_cap_pct <- c(EPL_away_cap, Bundesliga_away_cap, Ligue_1_away_cap, La_Liga_away_cap, Serie_A_away_cap)
away_cap_pct_weighted <- c(EPL_away_cap_weighted, Bundesliga_away_cap_weighted, Ligue_1_away_cap_weighted,
La_Liga_away_cap_weighted, Serie_A_away_cap_weighted)
away_cap_by_league <- data.frame(League, away_cap_pct)
away_cap_by_league_weighted <- data.frame(League, away_cap_pct_weighted)
away_cap_by_league_final <- away_cap_by_league %>%
arrange(desc(away_cap_pct))
away_cap_by_league_weighted_final <- away_cap_by_league_weighted %>%
arrange(desc(away_cap_pct_weighted))
home_field_cap_by_league_final
away_cap_by_league_final
away_cap_by_league_weighted_final
away_cap_by_league_final %>%
ggplot(aes(x = reorder(League, -away_cap_pct) , y = away_cap_pct,
fill = away_cap_pct)) +
geom_bar(stat = 'identity') +
xlab('League') +
ylab('Away Capitalization')
away_cap_by_league_weighted_final %>%
ggplot(aes(x = reorder(League, -away_cap_weighted_pct) , y = away_cap_weighted_pct,
fill = away_cap_weighted_pct)) +
geom_bar(stat = 'identity') +
xlab('League') +
ylab('Away Capitalization (Weighted)')
away_cap_by_league_weighted_final %>%
ggplot(aes(x = reorder(League, -away_cap_pct_weighted) , y = away_cap_pct_weighted,
fill = away_cap_pct_weighted)) +
geom_bar(stat = 'identity') +
xlab('League') +
ylab('Away Capitalization (Weighted)')
summary(football_europe)
home_field_cap_by_league_final %>%
ggplot(aes(x = reorder(League, -home_field_cap_pct) , y = home_field_cap_pct,
fill = home_field_cap_pct)) +
geom_bar(stat = 'identity') +
xlab('League') +
ylab('Home Field Capitalization')
away_cap_by_league_final %>%
ggplot(aes(x = reorder(League, -away_cap_pct) , y = away_cap_pct,
fill = away_cap_pct)) +
geom_bar(stat = 'identity') +
xlab('League') +
ylab('Away Capitalization')
away_cap_by_league_final %>%
ggplot(aes(x = reorder(League, away_cap_pct) , y = away_cap_pct,
fill = away_cap_pct)) +
geom_bar(stat = 'identity') +
xlab('League') +
ylab('Away Capitalization')
away_cap_by_league_final %>%
ggplot(aes(x = reorder(League, -away_cap_pct) , y = away_cap_pct,
fill = away_cap_pct)) +
geom_bar(stat = 'identity') +
xlab('League') +
ylab('Away Capitalization')
away_cap_by_league_weighted_final %>%
ggplot(aes(x = reorder(League, -away_cap_pct_weighted) , y = away_cap_pct_weighted,
fill = away_cap_pct_weighted)) +
geom_bar(stat = 'identity') +
xlab('League') +
ylab('Away Capitalization (Weighted)')
football_europe_new_col_order %>%
group_by(division) %>%
summarise(total_goals = sum(homeGoalFT, awayGoalFT)) %>%
ggplot(aes(x = reorder(division, -total_goals), y = total_goals, fill = total_goals)) +
geom_bar(stat = 'identity')
football_europe_new_col_order %>%
group_by(division, homeTeam) %>%
summarise(total_games = n(), total_goals = sum(homeGoalFT),
home_capitalization = mean(homeWin),
goals_per_game = total_goals / total_games) %>%
arrange(division, desc(home_capitalization))
football_europe_new_col_order %>%
filter(division == 'Bundesliga') %>%
group_by(homeTeam) %>%
summarise(total_games = n(), total_home_wins = sum(homeWin),
home_capitalization = mean(homeWin)) %>%
filter(total_games >= 34) %>%
arrange(desc(home_capitalization))
football_europe_new_col_order %>%
filter(division == 'Bundesliga') %>%
group_by(awayTeam) %>%
summarise(total_games = n(), total_away_wins = sum(awayWin),
away_capitalization = mean(awayWin)) %>%
filter(total_games >= 38) %>%
arrange(desc(away_capitalization))
data.frame(away_result, home_result)
cm
install.packages('BTYD')
library("BTYD", lib.loc="/Library/Frameworks/R.framework/Versions/3.4/Resources/library")
btyd
BTYD
diamonds
names(flights)
library(nycflights13)
names(flights)
unique(flights$dep_time)
unique(is.na(flights$dep_time))
flights %>%
summarise(cancelled = is.na(dep_time) == TRUE)
flights %>%
mutatue(cancelled = is.na(dep_time))
flights %>%
mutate(cancelled = is.na(dep_time))
flights %>%
mutate(cancelled = case.when(is.na(dep_time) == TRUE ~ 1,
is.na(dep_time) != TRUE ~ 0))
flights %>%
mutate(cancelled = case_when(is.na(dep_time) == TRUE ~ 1,
is.na(dep_time) != TRUE ~ 0))
flights %>%
mutate(cancelled = as.integer(case_when(is.na(dep_time) == TRUE ~ 1,
is.na(dep_time) != TRUE ~ 0)))
